<!doctype html><html lang=en><head><link href="https://mort.io/abridge.css?h=ef0df812e427238e124c" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=https://mort.io name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><link title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml rel=alternate type=application/atom+xml><link title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml rel=alternate type=application/rss+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>A 21st Century IDE | mort’s mythopœia</title><meta content="mort’s mythopœia" name=copyright><meta content="Merlin, Tuareg and <code>ocp-indent</code>" name=description><link href=https://mort.io/blog/21st-century-ide/ rel=canonical><meta content=https://mort.io/blog/21st-century-ide/ property=og:url><meta content=https://mort.io/blog/21st-century-ide/ name=twitter:url><meta content="Merlin, Tuareg and <code>ocp-indent</code>" property=og:description><meta content="Merlin, Tuareg and <code>ocp-indent</code>" name=twitter:description><meta content="A 21st Century IDE | mort’s mythopœia" property=og:title><meta content="A 21st Century IDE | mort’s mythopœia" name=twitter:title><meta content=summary name=twitter:card><meta content="mort’s mythopœia" property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta content=2013-10-13 property=og:updated_time><noscript><link href=https://mort.io/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a title="mort’s mythopœia" href=https://mort.io>mort’s mythopœia</a></big></div><div><div><ul><li><a class=s110 href=https://mort.io/research/> research </a><li><a class=s110 href=https://mort.io/students/> students </a><li><a class=s110 href=https://mort.io/teaching/> teaching </a><li><a class=s110 href=https://mort.io/codes/> codes </a><li><a class=s110 href=https://mort.io/me/> me </a></ul></div><div></div></div></nav><div class=desc>with apologies</div><hr></header><main><article><h1><a href=https://mort.io/blog/21st-century-ide/>A 21st Century IDE</a></h1><span class=s95><span class=hpad> ·</span> 2 min read<span class=hpad> ·</span> October 13, 2013<span class=hpad> ·</span> #<a href=https://mort.io/tags/ocaml/>ocaml</a> #<a href=https://mort.io/tags/tech/>tech</a> #<a href=https://mort.io/tags/config/>config</a> #<a href=https://mort.io/tags/emacs/>emacs</a> </span><nav><div><a href=https://mort.io/blog/begin-again/>‹ Begin, Again!</a></div><div></div></nav><p>I finally decided to sit down and get the shiny new <a href=http://kiwi.iuwt.fr/~asmanur/blog/merlin/>merlin</a> mode for OCaml working with my emacs configuration. Basically, really rather simple in the end although (in the usual fashion!) I did end up spending considerable time tweaking various other customisations…<p>Most of the information below is based on the following sources:<ul><li><a href=http://github.com/def-lkb/merlin#emacs-interface>http://github.com/def-lkb/merlin#emacs-interface</a><li><a href=http://zheng.li/buzzlogs-ocaml/2013/08/23/irc.html>http://zheng.li/buzzlogs-ocaml/2013/08/23/irc.html</a><li><a href=http://www.ocamlpro.com/blog/2013/03/18/monthly-03.html>http://www.ocamlpro.com/blog/2013/03/18/monthly-03.html</a></ul><p>Before we begin, install <code>merlin</code>:<pre class=z-code><code><span class="z-text z-plain">$ opam install merlin
</span></code></pre><p>The complete <a href=https://github.com/mor1/rc-files/commit/4a2b0be59081d6df0640af39b48c75c20443c8dc>commit</a> change is in my <a href=http://github.com/mor1>github</a> account (combined with a large cleanup of various other aborted OCaml configurations). Breaking it down a bit, first setup some paths: where to find <code>ocp-indent</code>, <code>merlin.el</code> for <code>merlin-mode</code>, and the <code>ocamlmerlin</code> command itself. Note that this relies on the current state of <code>opam</code>, so when you start <code>emacs</code> be sure to have selected the <code>opam</code> compiler-switch that you installed the <code>merlin</code> package into, above.<pre class="language-lisp z-code" data-lang=lisp><code class=language-lisp data-lang=lisp><span class="z-source z-lisp"><span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; ocp-indent
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">load</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>concat
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">            <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>substring <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>shell<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>command<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">to</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">string</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>opam config var prefix<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-constant z-numeric z-lisp">0</span> <span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-constant z-numeric z-lisp">1</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">            <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>/share/typerex/ocp-indent/ocp-indent.el<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">            <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span><span class="z-source z-lisp">
</span><span class="z-source z-lisp"><span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; merlin-mode
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">push</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>concat
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">       <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>substring <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>shell<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>command<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">to</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">string</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>opam config var share<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-constant z-numeric z-lisp">0</span> <span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-constant z-numeric z-lisp">1</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">       <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>/emacs/site-lisp<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">       <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">      <span class="z-support z-function z-lisp">load</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>path<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span><span class="z-source z-lisp">
</span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">setq</span> merlin<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>command
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>concat
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">       <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>substring <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>shell<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>command<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">to</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">string</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>opam config var bin<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-constant z-numeric z-lisp">0</span> <span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-constant z-numeric z-lisp">1</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">       <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>/ocamlmerlin<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">       <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>autoload 'merlin<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>merlin<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>Merlin mode<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> <span class="z-constant z-language z-lisp">t</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></code></pre><p>Now the meat: when we select <code>tuareg-mode</code>, use <code>ocp-indent</code> to indent lines, turn on <code>merlin</code> auto-complete, and finally set a couple of local key bindings so that I can fix up <code>merlin</code> to not conflict with my now-neurologically-hardwired navigation keys.<pre class="language-lisp z-code" data-lang=lisp><code class=language-lisp data-lang=lisp><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>add<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>hook 'tuareg<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>hook
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">          '<span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">lambda</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>merlin<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">setq</span> indent<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>line<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>function 'ocp<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>indent<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>line<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">setq</span> merlin<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>use<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>auto<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>complete<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode <span class="z-constant z-language z-lisp">t</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>local<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">set</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>key <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>kbd <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>C-S-&LTup><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> 'merlin<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>type<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>enclosing<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>go<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>up<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>local<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">set</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>key <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>kbd <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>C-S-&LTdown><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> 'merlin<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>type<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>enclosing<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>go<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>down<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></code></pre><p>Finally, do the usual to use <code>tuareg-mode</code> for OCaml/F# editing.<pre class="language-lisp z-code" data-lang=lisp><code class=language-lisp data-lang=lisp><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">push</span>'<span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span><span class="z-constant z-character z-escape z-lisp">\\</span>.ml[iylp]?<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> . tuareg<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> auto<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">push</span> '<span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span><span class="z-constant z-character z-escape z-lisp">\\</span>.fs[ix]?<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> . tuareg<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> auto<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></code></pre><p>And that’s it!<nav><div><a href=https://mort.io/blog/begin-again/>‹ Begin, Again!</a></div><div></div></nav></article></main><footer><hr><div class=c><nav class=tpad><div><a title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml target=_blank type=application/atom+xml><i class="svg rss" title="mort’s mythopœia Atom Feed" type=Button></i></a><a title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml target=_blank type=application/rss+xml><i class="svg rss" title="mort’s mythopœia RSS Feed" type=Button></i></a><a href=mailto:richard.mortier@cl.cam.ac.uk target=_blank title=Mail><i class="svg mail" title=Mail type=Button></i></a><a href=https://mastodon.me.uk/@mort rel=me target=_blank title=Mastodon><i class="svg mastodon" title=Mastodon type=Button></i></a><a href=https://www.linkedin.com/in/richard-mortier/ target=_blank title=LinkedIn><i class="svg linkedin" title=LinkedIn type=Button></i></a><a href=https://github.com/mor1/ target=_blank title=Github><i class="svg github" title=Github type=Button></i></a><a href=https://hub.docker.com/u/mor1/ target=_blank title=Docker><i class="svg docker" title=Docker type=Button></i></a><a href="https://www.youtube.com/playlist?list=PLkRF0fgqvvMx5Owh1QgilmExGQe58go_u" target=_blank title=YouTube><i class="svg youtube" title=YouTube type=Button></i></a></div></nav><nav class=vpad><a class=rpad href=https://mort.io/sitemap.xml target=_blank> sitemap </a><a class=rpad href=https://mort.io/tags/> tags </a></nav><p class=s90>mort’s mythopœia © 2013—<span id=year>2025</span> Richard Mortier</div></footer>