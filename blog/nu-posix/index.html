<!doctype html><html lang=en><head><link href="https://mort.io/abridge.css?h=ef0df812e427238e124c" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=https://mort.io name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><link title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml rel=alternate type=application/atom+xml><link title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml rel=alternate type=application/rss+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Rusty Nu POSIX | mort’s mythopœia</title><meta content="mort’s mythopœia" name=copyright><meta content="The GNU is Dead! Long Live the GNU!" name=description><link href=https://mort.io/blog/nu-posix/ rel=canonical><meta content=https://mort.io/blog/nu-posix/ property=og:url><meta content=https://mort.io/blog/nu-posix/ name=twitter:url><meta content="The GNU is Dead! Long Live the GNU!" property=og:description><meta content="The GNU is Dead! Long Live the GNU!" name=twitter:description><meta content="Rusty Nu POSIX | mort’s mythopœia" property=og:title><meta content="Rusty Nu POSIX | mort’s mythopœia" name=twitter:title><meta content=summary name=twitter:card><meta content="mort’s mythopœia" property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta content=2025-05-07 property=og:updated_time><noscript><link href=https://mort.io/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a title="mort’s mythopœia" href=https://mort.io>mort’s mythopœia</a></big></div><div><div><ul><li><a class=s110 href=https://mort.io/research/> research </a><li><a class=s110 href=https://mort.io/students/> students </a><li><a class=s110 href=https://mort.io/teaching/> teaching </a><li><a class=s110 href=https://mort.io/codes/> codes </a><li><a class=s110 href=https://mort.io/me/> me </a></ul></div><div></div></div></nav><div class=desc>with apologies</div><hr></header><main><article><h1><a href=https://mort.io/blog/nu-posix/>Rusty Nu POSIX</a></h1><span class=s95><span class=hpad> ·</span> 5 min read<span class=hpad> ·</span> May 07, 2025<span class=hpad> ·</span> #<a href=https://mort.io/tags/tech/>tech</a> #<a href=https://mort.io/tags/dev/>dev</a> #<a href=https://mort.io/tags/nixos/>nixos</a> </span><nav><div><a href=https://mort.io/blog/sermonising/>‹ Artificial Intelligence, but at what cost?</a></div><div><a href=https://mort.io/blog/coping-and-capping/> Coping and Capping ›</a></div></nav><p>A slight delay to this post, but happily I now have no more lecturing to do until 2027<sup class=footnote-reference><a href=#1>1</a></sup> :)<p>I switched a year or two ago to using NixOS as my daily driver following about 15 years as an increasingly irritated MacOS user. Shortly before I had become interested in Rust as a systems programming language that seemed to marry several things I like about OCaml with several other desirable things from C and Python.<p>I then more recently observed something that I thought was interesting: there seem to be a <strong>lot</strong> of recent replacements of what were once completely standard and changeless POSIX utilities. I’m thinking things like <code>grep</code>, <code>find</code>, <code>ls</code> and the like that I’ve been using uninterrupted, other than the occasional quibble over whether it was the original version or the GNU version, for about 30 years. Indeed, I have already raved (slightly) about <a href=https://just.systems/><code>just</code></a> as a <a href=https://www.gnu.org/software/make/manual/make.html><code>make</code></a> replacement and its use with <a href=/blog/just-ocaml/>OCaml</a> and <a href=/blog/just-latex/>LaTeX</a>.<p>NixOS’ declarative configuration meant that I could actually see the list growing, all in one place – I suspect on other systems I wouldn’t have noticed in quite the same way because it would’ve been a much more incremental and diffuse process of change without a clear record of the choices made.<p>I thus find in my <a href=https://github.com/mor1/rc-files/blob/main/nixos/modules/home-manager/cli.nix#L44-L65><code>cli.nix</code></a> config that describes the CLI tools I expect, to have the following collection:<pre class="language-nix z-code" data-lang=nix><code class=language-nix data-lang=nix><span class="z-source z-nix">      <span class="z-variable z-parameter z-name z-nix">nu_posix</span> <span class="z-invalid z-illegal">=</span> <span class="z-punctuation z-definition z-list z-nix">[</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">bat</span> <span class="z-comment z-line z-number-sign z-nix"># better cat</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">bottom</span> <span class="z-comment z-line z-number-sign z-nix"># btm ~ better top, htop, etc</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">broot</span> <span class="z-comment z-line z-number-sign z-nix"># interactive directory navigation</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">chafa</span> <span class="z-comment z-line z-number-sign z-nix"># terminal graphics viewer</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">ctpv</span> <span class="z-comment z-line z-number-sign z-nix"># terminal file previewer</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">cyme</span> <span class="z-comment z-line z-number-sign z-nix"># better `lsusb`</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">delta</span> <span class="z-comment z-line z-number-sign z-nix"># better syntax highlighting diff</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">dua</span> <span class="z-comment z-line z-number-sign z-nix"># disk usage, interactively</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">eza</span> <span class="z-comment z-line z-number-sign z-nix"># improved `ls`</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">fd</span> <span class="z-comment z-line z-number-sign z-nix"># `find` replacement</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">fend</span> <span class="z-comment z-line z-number-sign z-nix"># better CLI calculator</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">hexyl</span> <span class="z-comment z-line z-number-sign z-nix"># hex pretty printer</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">htop</span> <span class="z-comment z-line z-number-sign z-nix"># graphical top</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">iotop</span> <span class="z-comment z-line z-number-sign z-nix"># io top</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">jujutsu</span> <span class="z-comment z-line z-number-sign z-nix"># better git</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">just</span> <span class="z-comment z-line z-number-sign z-nix"># updated gnumake replacement</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">procs</span> <span class="z-comment z-line z-number-sign z-nix"># better ps</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">ripgrep</span> <span class="z-comment z-line z-number-sign z-nix"># rg ~ `grep` replacement</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">sudo-rs</span> <span class="z-comment z-line z-number-sign z-nix"># memory-safe `sudo`</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">uutils-coreutils-noprefix</span> <span class="z-comment z-line z-number-sign z-nix"># replaces GNU `coreutils`</span>
</span><span class="z-source z-nix">        <span class="z-variable z-parameter z-name z-nix">viddy</span> <span class="z-comment z-line z-number-sign z-nix"># better watch</span>
</span><span class="z-source z-nix">      <span class="z-punctuation z-definition z-list z-nix">]</span><span class="z-invalid z-illegal">;</span>
</span></code></pre><p>I think that most, if not all, of these are written in Rust: that particular language community seems to have a real enthusiasm for re-implementing long-standing tools but better, and I have to say I really appreciate it! When I say “better” I’m not particularly thinking of esoteric language features or development ideologies either. I mean better in two very particular senses:<ol><li><p><strong>Usability</strong>. Many of the older tools simply did not have great user interfaces and, when they were ok, they were not built using modern tooling. As a result getting documentation was somewhere between good and great if there was a decent <code>man</code>-page, with a range of potential switches for more short form help or for cases where the <code>man</code>-page was not installed – whether <code>-h</code>, <code>--help</code>, <code>-help</code>, <code>-?</code>, <code>help</code>, or something else. The short-form help would, of course, be formatted in arbitrary ways.</p> <p>The modern Rust-y replacements tend to use <a href=https://docs.rs/clap/latest/clap/><code>clap</code></a> as a reasonably standard command-line parser. As a result, they are remarkably consistent in usage and format, typically producing something that looks a lot like <code>man</code>-page output in response to their <code>-h|--help</code> switch. In a world where <code>man</code>-pages are often an afterthought or, even worse, replaced by <code>info</code> documentation, I find this invaluable. They are also generally inclined to make greater use of modern terminal environments – <a href=https://github.com/eza-community/eza><code>eza</code></a> as a replacement for <a href=https://www.gnu.org/software/coreutils/manual/html_node/ls-invocation.html><code>ls</code></a> is a good example of this.</p><li><p><strong>Performance</strong>. Old tools were originally built for old computers in old languages (largely C) and, whether this is language ideology or just the practicalities of engineering long-standing widely-used codebases, tended not to be radically updated.</p> <p>Rust re-implementations, on the other hand, are from scratch – and Rust’s memory model appears to make it relatively easy for them to be made multi-threaded. On modern hardware this seems to make them startlingly higher performance than the alternatives. Tools I particularly appreciate for this include <a href=https://github.com/sharkdp/fd><code>fd</code></a> replacing <a href=https://www.gnu.org/software/findutils/><code>find</code></a> and <a href=https://github.com/BurntSushi/ripgrep>ripgrep, <code>rg</code>,</a> replacing <a href=https://www.gnu.org/software/grep/><code>grep</code></a>.</p></ol><p>Perhaps the most immediate example of the benefits of this that I’ve experienced is <a href=https://github.com/Byron/dua-cli><code>dua</code></a> via <code>dua i</code>. Traditionally, when trying to clean up an uncomfortably full hard disk I would’ve ended up using some manual iterative application of either <code>du -hS *</code> or possibly something like <code>find ... | xargs du</code>. Or possibly written a Python script to do it for me. And it would’ve taken <em>O</em>(hours) for me to find where the space was being used and to do something about it. And I would’ve found it tedious and deeply irritating.<sup class=footnote-reference><a href=#2>2</a></sup><p>In contrast, <code>dua i</code> gives me a TUI interface to navigate the filesystem from wherever I run it, the ability to cumulatively mark files and directories for trashing or immediate deletion, with subdirectory space summaries – and does so across ~850GB / 3 million files in about 10-15 seconds without using any form of caching, database, or other such thing. As far as I can tell, simply by being efficient and multi-threaded.<p>If this is the future, sign me up. (At least for the bits like this that are good.)<div class=footnote-definition id=1><sup class=footnote-definition-label>1</sup><p>…assuming I get back the same courses after my sabbatical that is.</div><div class=footnote-definition id=2><sup class=footnote-definition-label>2</sup><p>I’m easily irritated. What can I say.</div><nav><div><a href=https://mort.io/blog/sermonising/>‹ Artificial Intelligence, but at what cost?</a></div><div><a href=https://mort.io/blog/coping-and-capping/> Coping and Capping ›</a></div></nav></article></main><footer><hr><div class=c><nav class=tpad><div><a title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml target=_blank type=application/atom+xml><i class="svg rss" title="mort’s mythopœia Atom Feed" type=Button></i></a><a title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml target=_blank type=application/rss+xml><i class="svg rss" title="mort’s mythopœia RSS Feed" type=Button></i></a><a href=mailto:richard.mortier@cl.cam.ac.uk target=_blank title=Mail><i class="svg mail" title=Mail type=Button></i></a><a href=https://mastodon.me.uk/@mort rel=me target=_blank title=Mastodon><i class="svg mastodon" title=Mastodon type=Button></i></a><a href=https://www.linkedin.com/in/richard-mortier/ target=_blank title=LinkedIn><i class="svg linkedin" title=LinkedIn type=Button></i></a><a href=https://github.com/mor1/ target=_blank title=Github><i class="svg github" title=Github type=Button></i></a><a href=https://hub.docker.com/u/mor1/ target=_blank title=Docker><i class="svg docker" title=Docker type=Button></i></a><a href="https://www.youtube.com/playlist?list=PLkRF0fgqvvMx5Owh1QgilmExGQe58go_u" target=_blank title=YouTube><i class="svg youtube" title=YouTube type=Button></i></a></div></nav><nav class=vpad><a class=rpad href=https://mort.io/sitemap.xml target=_blank> sitemap </a><a class=rpad href=https://mort.io/tags/> tags </a></nav><p class=s90>mort’s mythopœia © 2013—<span id=year>2025</span> Richard Mortier</div></footer><span class=topout> <span class=topleft> </span><a title="Back to Top" class=top href=#><i class="svgs svgh angu"></i></a> </span>