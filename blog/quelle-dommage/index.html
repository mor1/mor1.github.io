<!doctype html><html lang=en><head><link href="https://mort.io/abridge.css?h=5f1494977bbccc1fddc1" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=https://mort.io name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><link title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml rel=alternate type=application/atom+xml><link title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml rel=alternate type=application/rss+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Quelle dommage | mort’s mythopœia</title><meta content="mort’s mythopœia" name=copyright><meta content="Containerising Mirage" name=description><link href=https://mort.io/blog/quelle-dommage/ rel=canonical><meta content=https://mort.io/blog/quelle-dommage/ property=og:url><meta content=https://mort.io/blog/quelle-dommage/ name=twitter:url><meta content="Containerising Mirage" property=og:description><meta content="Containerising Mirage" name=twitter:description><meta content="Quelle dommage | mort’s mythopœia" property=og:title><meta content="Quelle dommage | mort’s mythopœia" name=twitter:title><meta content=summary name=twitter:card><meta content="mort’s mythopœia" property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta content=2017-11-05 property=og:updated_time><noscript><link href=https://mort.io/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a title="mort’s mythopœia" href=https://mort.io>mort’s mythopœia</a></big></div><div><div><ul><li><a class=s110 href=https://mort.io/research/> research </a><li><a class=s110 href=https://mort.io/students/> students </a><li><a class=s110 href=https://mort.io/teaching/> teaching </a><li><a class=s110 href=https://mort.io/codes/> codes </a><li><a class=s110 href=https://mort.io/me/> me </a></ul></div><div></div></div></nav><div class=desc>with apologies</div><hr></header><main><article><h1><a href=https://mort.io/blog/quelle-dommage/>Quelle dommage</a></h1><span class=s95><span class=hpad> ·</span> 2 min read<span class=hpad> ·</span> November 05, 2017<span class=hpad> ·</span> #<a href=https://mort.io/tags/tech/>tech</a> #<a href=https://mort.io/tags/linux/>linux</a> #<a href=https://mort.io/tags/old/>old</a> #<a href=https://mort.io/tags/docker/>docker</a> #<a href=https://mort.io/tags/mirage/>mirage</a> #<a href=https://mort.io/tags/unikernels/>unikernels</a> </span><nav><div><a href=https://mort.io/blog/back-to-the-future/>‹ Back to the Future</a></div><div><a href=https://mort.io/blog/mess-with-my-keyboard/> Spring Loading Karabiner in the Autumn ›</a></div></nav><blockquote><p>Ed: this tool is perhaps less relevant now that both <a href=https://mirage.io/ rel=external>Mirage</a> and <a href=https://ocaml.org/opam/ rel=external>OPAM</a> have moved on. But perhaps it’ll be resurrected one day so here it is.</blockquote><p>Largely because I wanted to make a feeble attempt at a French pun, <a href=https://github.com/mor1/dommage/ rel=external><code>dommage</code></a> is a tool for <a href=https://docker.com/ rel=external>Docker</a> containerising Mirage unikernels. From the <a href=https://github.com/mor1/dommage rel=external>README</a>:<h2 id=dommage-dockerised-mirage><a aria-label="Anchor link for: dommage-dockerised-mirage" class=zola-anchor href=#dommage-dockerised-mirage>Dommage, Dockerised Mirage</a></h2><p><code>dommage</code> is a shell script that wraps the <a href=https://mirage.io rel=external>Mirage</a> CLI to make use of Docker containers meaning that:<ul><li>you can cache the OPAM build artefacts in the container image, speeding up local builds;<li>you can re-use the build container image in Travis builds by publishing it, speeding those up considerably; and<li>you can easily test build <code>-t xen</code> targets on OSX.</ul><p>I’ve tried to minimise interference with the normal operation of <a href=https://mirage.io rel=external>Mirage</a> CLI so simply replacing <code>mirage</code> with <code>dommage</code> is supposed to work. To publish the resulting container image, <code>dommage publish &lt;image></code>.<p>Issues, comments, suggestions and bug fixes all welcome!<h3 id=operation><a aria-label="Anchor link for: operation" class=zola-anchor href=#operation>Operation</a></h3><p>To start, <code>dommage</code> provides a few management commands to manipulate the build container:<ul><li><code>dommage init BASE-IMAGE</code> creates a new container, based off <code>BASE-IMAGE</code> from the <a href=https://hub.docker.com rel=external>Docker Hub</a><li><code>dommage publish IMAGE</code> commits the current container and pushes it to <a href=https://hub.docker.com rel=external>Docker Hub</a> as <code>IMAGE</code><li><code>dommage destroy</code> stops and removes the current build container<li><code>dommage run ...</code> executes a command inside the current build container</ul><p>In addition, it wraps the main <a href=https://mirage.io rel=external>Mirage</a> CLI commands:<ul><li><code>dommage configure ...</code> runs <code>mirage configure ... && make depends</code> inside the build contianer<li><code>dommage build ...</code> runs <code>mirage build ...</code> inside the build container<li><code>dommage clean ...</code> runs <code>mirage clean ...</code> inside the build container</ul><nav><div><a href=https://mort.io/blog/back-to-the-future/>‹ Back to the Future</a></div><div><a href=https://mort.io/blog/mess-with-my-keyboard/> Spring Loading Karabiner in the Autumn ›</a></div></nav></article></main><footer><hr><div class=c><nav class=tpad><div><a title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml target=_blank type=application/atom+xml><i class="svg rss" title="mort’s mythopœia Atom Feed" type=Button></i></a><a title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml target=_blank type=application/rss+xml><i class="svg rss" title="mort’s mythopœia RSS Feed" type=Button></i></a><a href=mailto:richard.mortier@cl.cam.ac.uk target=_blank title=Mail><i class="svg mail" title=Mail type=Button></i></a><a href=https://mastodon.me.uk/@mort rel=me target=_blank title=Mastodon><i class="svg mastodon" title=Mastodon type=Button></i></a><a href=https://www.linkedin.com/in/richard-mortier/ target=_blank title=LinkedIn><i class="svg linkedin" title=LinkedIn type=Button></i></a><a href=https://github.com/mor1/ target=_blank title=Github><i class="svg github" title=Github type=Button></i></a><a href=https://hub.docker.com/u/mor1/ target=_blank title=Docker><i class="svg docker" title=Docker type=Button></i></a><a href="https://www.youtube.com/playlist?list=PLkRF0fgqvvMx5Owh1QgilmExGQe58go_u" target=_blank title=YouTube><i class="svg youtube" title=YouTube type=Button></i></a></div></nav><nav class=vpad><a class=rpad href=https://mort.io/sitemap.xml target=_blank> sitemap </a><a class=rpad href=https://mort.io/tags/> tags </a></nav><p class=s90>mort’s mythopœia © 2013—<span id=year>2026</span> Richard Mortier</div></footer>