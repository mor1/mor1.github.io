<!doctype html><html lang=en><head><link href="https://mort.io/abridge.css?h=5f1494977bbccc1fddc1" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=https://mort.io name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><link title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml rel=alternate type=application/atom+xml><link title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml rel=alternate type=application/rss+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Pinning packages | mort’s mythopœia</title><meta content="mort’s mythopœia" name=copyright><meta content="Seems harder than it should be but..." name=description><link href=https://mort.io/blog/pinning-pkgs/ rel=canonical><meta content=https://mort.io/blog/pinning-pkgs/ property=og:url><meta content=https://mort.io/blog/pinning-pkgs/ name=twitter:url><meta content="Seems harder than it should be but..." property=og:description><meta content="Seems harder than it should be but..." name=twitter:description><meta content="Pinning packages | mort’s mythopœia" property=og:title><meta content="Pinning packages | mort’s mythopœia" name=twitter:title><meta content=summary name=twitter:card><meta content="mort’s mythopœia" property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta content=2026-01-12 property=og:updated_time><noscript><link href=https://mort.io/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a title="mort’s mythopœia" href=https://mort.io>mort’s mythopœia</a></big></div><div><div><ul><li><a class=s110 href=https://mort.io/research/> research </a><li><a class=s110 href=https://mort.io/students/> students </a><li><a class=s110 href=https://mort.io/teaching/> teaching </a><li><a class=s110 href=https://mort.io/codes/> codes </a><li><a class=s110 href=https://mort.io/me/> me </a></ul></div><div></div></div></nav><div class=desc>with apologies</div><hr></header><main><article><h1><a href=https://mort.io/blog/pinning-pkgs/>Pinning packages</a></h1><span class=s95><span class=hpad> ·</span> 3 min read<span class=hpad> ·</span> January 12, 2026<span class=hpad> ·</span> #<a href=https://mort.io/tags/tech/>tech</a> #<a href=https://mort.io/tags/linux/>linux</a> #<a href=https://mort.io/tags/nixos/>nixos</a> </span><nav><div><a href=https://mort.io/blog/extracting-rambling/>‹ Extracting ramblings</a></div><div><a href=https://mort.io/blog/sabbatical-diary-w14/> Sabbatical Diary: Week 14 ›</a></div></nav><p>I run NixOS for the time being, usually tracking <code>unstable</code>. As a result, I have from time to time found myself wanting to pin a package to a particular (older) version because a package update doesn’t work, or at least doesn’t work for me.<p>Given what I understand NixOS’ intention to be—encapsulation of state, eschewing the convenience of the <a href=https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard rel=external>Filesystem Hierarchy Standard (FHS)</a> for a layout that allows multiple versions of the same package to exist alongside each other—I always assumed this would be fairly straightforward. Just specify the version of the package rather than accepting the default from the channel, and off you go with all dependencies neatly installed alongside whatever else there is.<p>Unfortunately not. And the amount of half-written, possibly once working, now incomplete or just wrong hints at solutions that are out there is something I have found infuriating.<sup class=footnote-reference id=fr-seriously-1><a href=#fn-seriously>1</a></sup><p>I needed to do this again last week because something happened with the latest <a href=https://pipewire.pages.freedesktop.org/wireplumber/ rel=external><code>wireplumber</code></a>. And this time I managed to make it work, so again, recording it here for future-me and anyone else who might find it useful.<sup class=footnote-reference id=fr-noting-1><a href=#fn-noting>2</a></sup><p>Setup is one that I think is reasonably common: I have a Nix <em>flake</em> that declares a set of systems; each <em>system</em> references a per-machine set of modules; each <em>module</em> then pulls in a configuration that installs and configures some packages in the usual way.<p>So my laptop’s <code>default.nix</code> now contains the following two <code>let</code> declarations specifying the <code>nixpkgs</code> repository version with the correct (in this case, previous) <code>wireplumber</code> package plus the package itself within that repository. The declarations that then cause <code>wireplumber</code> to be installed then just have to override the <code>wireplumber.package</code> to use the pinned one just declared.<pre class=giallo style=color:#839496;background-color:#002b36><code data-lang=nix><span class=giallo-l><span>{</span></span>
<span class=giallo-l><span>  inputs</span><span style=color:#859900>,</span></span>
<span class=giallo-l><span>  lib</span><span style=color:#859900>,</span></span>
<span class=giallo-l><span>  pkgs</span><span style=color:#859900>,</span></span>
<span class=giallo-l><span>  options</span><span style=color:#859900>,</span></span>
<span class=giallo-l><span style=color:#859900>  ...</span></span>
<span class=giallo-l><span>}:</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#859900>let</span></span>
<span class=giallo-l><span>  ...</span></span>
<span class=giallo-l><span style=color:#93a1a1>  wireplumber_0_5_12_pkgs</span><span style=color:#859900> =</span><span style=color:#268bd2> import</span><span> (</span><span style=color:#b58900>builtins</span><span style=color:#859900>.</span><span>fetchTree {</span></span>
<span class=giallo-l><span style=color:#93a1a1>    type</span><span style=color:#859900> =</span><span style=color:#2aa198> "github"</span><span>;</span></span>
<span class=giallo-l><span style=color:#93a1a1>    owner</span><span style=color:#859900> =</span><span style=color:#2aa198> "nixos"</span><span>;</span></span>
<span class=giallo-l><span style=color:#93a1a1>    repo</span><span style=color:#859900> =</span><span style=color:#2aa198> "nixpkgs"</span><span>;</span></span>
<span class=giallo-l><span style=color:#93a1a1>    rev</span><span style=color:#859900> =</span><span style=color:#2aa198> "871b9fd269ff6246794583ce4ee1031e1da71895"</span><span>;</span></span>
<span class=giallo-l><span>  }) {</span><span style=color:#859900> inherit</span><span> (pkgs)</span><span style=color:#93a1a1> system</span><span>; };</span></span>
<span class=giallo-l><span style=color:#93a1a1>  wireplumber_0_5_12</span><span style=color:#859900> =</span><span> wireplumber_0_5_12_pkgs</span><span style=color:#859900>.</span><span>wireplumber;</span></span>
<span class=giallo-l><span style=color:#859900>in</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#859900>  ...</span></span>
<span class=giallo-l><span>  services</span><span style=color:#859900>.</span><span>pipewire</span><span style=color:#dc322f> =</span><span> {</span></span>
<span class=giallo-l><span style=color:#93a1a1>    enable</span><span style=color:#859900> =</span><span style=color:#b58900> true</span><span>;</span></span>
<span class=giallo-l><span>    ...</span></span>
<span class=giallo-l><span style=color:#93a1a1>    wireplumber</span><span style=color:#859900> =</span><span> {</span></span>
<span class=giallo-l><span style=color:#93a1a1>      enable</span><span style=color:#859900> =</span><span style=color:#b58900> true</span><span>;</span></span>
<span class=giallo-l><span style=color:#93a1a1>      package</span><span style=color:#859900> =</span><span> wireplumber_0_5_12;</span></span>
<span class=giallo-l><span>    };</span></span>
<span class=giallo-l><span>  }</span><span style=color:#dc322f>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#859900>  ...</span></span>
<span class=giallo-l><span>  system</span><span style=color:#859900>.</span><span>stateVersion</span><span style=color:#dc322f> =</span><span style=color:#2aa198> "24.05"</span><span style=color:#dc322f>;</span></span>
<span class=giallo-l><span style=color:#dc322f>}</span></span></code></pre><p>To get the repo details, I initially used <a href="https://lazamar.co.uk/nix-versions/?channel=nixpkgs-unstable&package=wireplumber" rel=external>https://lazamar.co.uk/nix-versions/?channel=nixpkgs-unstable&package=wireplumber</a> but that seems only up-to-date to wireplumber 0.5.10, whereas the previous version should be 0.5.12.<p>So to find the correct repo revision, I went back to <a href="https://search.nixos.org/packages?channel=25.11&query=wireplumber" rel=external>https://search.nixos.org/packages?channel=25.11&query=wireplumber</a> to find the latest stable version, clicked on the <em>Source</em> link to take me to <a href=https://github.com/NixOS/nixpkgs/blob/nixos-25.11/pkgs/development/libraries/pipewire/wireplumber.nix#L89 rel=external>https://github.com/NixOS/nixpkgs/blob/nixos-25.11/pkgs/development/libraries/pipewire/wireplumber.nix#L89</a>, realized that was in 25.11 so visited <code>Releases/Tags</code> > <code>Tags</code> > <code>25.11</code> which linked to <a href=https://github.com/NixOS/nixpkgs/commit/871b9fd269ff6246794583ce4ee1031e1da71895 rel=external>https://github.com/NixOS/nixpkgs/commit/871b9fd269ff6246794583ce4ee1031e1da71895</a>—giving me the commit ref to use above.<p>Probably, <em>surely</em>, easier ways to do this, but this way seemed to work for me.<section class=footnotes><ol class=footnotes-list><li id=fn-seriously><p>Seriously, if it’s so simple that you start your suggestion with “Just do something like …”, how about you post something a bit like a minimal working example? Or at least a reasonably complete fragment? It’s as bad as paper reviewers that baldly state “this work is not novel” without providing any pointers to the earlier work that invalidates the novelty. <a href=#fr-seriously-1>↩</a></p><li id=fn-noting><p>Though, noting my comment above, with no guarantees that it will work for you, now or ever, or that I’ll keep it up-to-date. This is a blog, of sorts, not a manual. <a href=#fr-noting-1>↩</a></p></ol></section><nav><div><a href=https://mort.io/blog/extracting-rambling/>‹ Extracting ramblings</a></div><div><a href=https://mort.io/blog/sabbatical-diary-w14/> Sabbatical Diary: Week 14 ›</a></div></nav></article></main><footer><hr><div class=c><nav class=tpad><div><a title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml target=_blank type=application/atom+xml><i class="svg rss" title="mort’s mythopœia Atom Feed" type=Button></i></a><a title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml target=_blank type=application/rss+xml><i class="svg rss" title="mort’s mythopœia RSS Feed" type=Button></i></a><a href=mailto:richard.mortier@cl.cam.ac.uk target=_blank title=Mail><i class="svg mail" title=Mail type=Button></i></a><a href=https://mastodon.me.uk/@mort rel=me target=_blank title=Mastodon><i class="svg mastodon" title=Mastodon type=Button></i></a><a href=https://www.linkedin.com/in/richard-mortier/ target=_blank title=LinkedIn><i class="svg linkedin" title=LinkedIn type=Button></i></a><a href=https://github.com/mor1/ target=_blank title=Github><i class="svg github" title=Github type=Button></i></a><a href=https://hub.docker.com/u/mor1/ target=_blank title=Docker><i class="svg docker" title=Docker type=Button></i></a><a href="https://www.youtube.com/playlist?list=PLkRF0fgqvvMx5Owh1QgilmExGQe58go_u" target=_blank title=YouTube><i class="svg youtube" title=YouTube type=Button></i></a></div></nav><nav class=vpad><a class=rpad href=https://mort.io/sitemap.xml target=_blank> sitemap </a><a class=rpad href=https://mort.io/tags/> tags </a></nav><p class=s90>mort’s mythopœia © 2013—<span id=year>2026</span> Richard Mortier</div></footer><span class=topout> <span class=topleft> </span><a title="Back to Top" class=top href=#><i class="svgs svgh angu"></i></a> </span>