<!doctype html><html lang=en><head><link href="https://mort.io/abridge.css?h=ef0df812e427238e124c" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=https://mort.io name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><link title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml rel=alternate type=application/atom+xml><link title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml rel=alternate type=application/rss+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Back to the Future | mort’s mythopœia</title><meta content="mort’s mythopœia" name=copyright><meta content="Spotlight on Time Machine" name=description><link href=https://mort.io/blog/back-to-the-future/ rel=canonical><meta content=https://mort.io/blog/back-to-the-future/ property=og:url><meta content=https://mort.io/blog/back-to-the-future/ name=twitter:url><meta content="Spotlight on Time Machine" property=og:description><meta content="Spotlight on Time Machine" name=twitter:description><meta content="Back to the Future | mort’s mythopœia" property=og:title><meta content="Back to the Future | mort’s mythopœia" name=twitter:title><meta content=summary name=twitter:card><meta content="mort’s mythopœia" property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta content=2017-12-14 property=og:updated_time><noscript><link href=https://mort.io/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a title="mort’s mythopœia" href=https://mort.io>mort’s mythopœia</a></big></div><div><div><ul><li><a class=s110 href=https://mort.io/research/> research </a><li><a class=s110 href=https://mort.io/students/> students </a><li><a class=s110 href=https://mort.io/teaching/> teaching </a><li><a class=s110 href=https://mort.io/codes/> codes </a><li><a class=s110 href=https://mort.io/me/> me </a></ul></div><div></div></div></nav><div class=desc>with apologies</div><hr></header><main><article><h1><a href=https://mort.io/blog/back-to-the-future/>Back to the Future</a></h1><span class=s95><span class=hpad> ·</span> 2 min read<span class=hpad> ·</span> December 14, 2017<span class=hpad> ·</span> #<a href=https://mort.io/tags/tech/>tech</a> #<a href=https://mort.io/tags/macos/>macos</a> #<a href=https://mort.io/tags/old/>old</a> </span><nav><div><a href=https://mort.io/blog/wipeout/>‹ Wipeout</a></div><div><a href=https://mort.io/blog/quelle-dommage/> Quelle dommage ›</a></div></nav><blockquote><p>Ed: the first in a likely series, this is one of the posts I drafted but never published during my seven years in the blogging wilderness</blockquote><p>I have been having persistent issues on MacOS with Time Machine backups interacting badly with several configuration elements and other services. This is exacerbated by my use of maildirs to backup emails, with my Gmail account leading to a directory with some millions of files. (Yeah, ok, maybe not wise but hey, we are where we are.)<p>So in the course of trying to get backups to work reliably, I found the following commands useful to at least some degree:<ul><li><code>mdutil -sav</code> to get info about spotlight indexing status<li><code>sudo mdutil -Ea -i [off|on]</code> to turn off|on spotlight indexing where possible<li><code>sudo fs_usage -w mdworker mds_stores backupd</code> obtain the current filesystem usage for those services<li><code>sudo fs_usage -w -e iTerm2</code> to obtain current filesystem usage for services <em>excluding</em> those listed<li><code>sudo sysctl debug.lowpri_throttle_enabled=[0|1]</code> stop|start throttling to go faster|be nice!<li>to obtain the various different hostnames that MacOS seems to want to give; note that renaming <code>ComputerName</code> (also possible via <code>SysPrefs>Sharing>>name</code>) caused the Time Machine directory to be renamed when the backup started</ul><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-keyword z-control z-loop z-for z-shell">for</span><span class="z-meta z-group z-for z-shell"> n <span class="z-keyword z-control z-in z-shell">in</span>  ComputerName LocalHostName HostName</span> <span class="z-keyword z-operator z-logical z-continue z-shell">;</span> <span class="z-keyword z-control z-loop z-do z-shell">do</span> 
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">scutil</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>get</span> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">n</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-control z-loop z-end z-shell">done</span>
</span></code></pre><ul><li><code>tmutil listbackups</code> to list backups<li><code>tmutil listlocalsnapshotdates /</code> to list local snapshots<li><code>tmutil destinationinfo</code> to list the Time Machine destination volumes<li>to stream Time Machine log entries live</ul><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">log</span></span><span class="z-meta z-function-call z-arguments z-shell"> stream<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>style</span> syslog<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>debug</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>info</span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  --</span>predicate</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>senderImagePath contains[cd] "TimeMachine"<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span></code></pre><ul><li>to show Time Machine log entries from YYYY-MM-DD</ul><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">log</span></span><span class="z-meta z-function-call z-arguments z-shell"> show<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>style</span> syslog<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>debug</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>info</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>start</span> YYYY-MM-DD <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  --</span>predicate</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>senderImagePath contains[cd] "TimeMachine"<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span><span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></code></pre><nav><div><a href=https://mort.io/blog/wipeout/>‹ Wipeout</a></div><div><a href=https://mort.io/blog/quelle-dommage/> Quelle dommage ›</a></div></nav></article></main><footer><hr><div class=c><nav class=tpad><div><a title="mort’s mythopœia Atom Feed" href=https://mort.io/atom.xml target=_blank type=application/atom+xml><i class="svg rss" title="mort’s mythopœia Atom Feed" type=Button></i></a><a title="mort’s mythopœia RSS Feed" href=https://mort.io/rss.xml target=_blank type=application/rss+xml><i class="svg rss" title="mort’s mythopœia RSS Feed" type=Button></i></a><a href=mailto:richard.mortier@cl.cam.ac.uk target=_blank title=Mail><i class="svg mail" title=Mail type=Button></i></a><a href=https://mastodon.me.uk/@mort rel=me target=_blank title=Mastodon><i class="svg mastodon" title=Mastodon type=Button></i></a><a href=https://www.linkedin.com/in/richard-mortier/ target=_blank title=LinkedIn><i class="svg linkedin" title=LinkedIn type=Button></i></a><a href=https://github.com/mor1/ target=_blank title=Github><i class="svg github" title=Github type=Button></i></a><a href=https://hub.docker.com/u/mor1/ target=_blank title=Docker><i class="svg docker" title=Docker type=Button></i></a><a href="https://www.youtube.com/playlist?list=PLkRF0fgqvvMx5Owh1QgilmExGQe58go_u" target=_blank title=YouTube><i class="svg youtube" title=YouTube type=Button></i></a></div></nav><nav class=vpad><a class=rpad href=https://mort.io/sitemap.xml target=_blank> sitemap </a><a class=rpad href=https://mort.io/tags/> tags </a></nav><p class=s90>mort’s mythopœia © 2013—<span id=year>2025</span> Richard Mortier</div></footer>