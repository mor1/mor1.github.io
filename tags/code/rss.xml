<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
      <title>mort’s mythopœia - code</title>
      <link>https://mort.io</link>
      <description>with apologies</description>
      <generator>Zola</generator>
      <language>en</language>
      <atom:link href="https://mort.io/tags/code/rss.xml" rel="self" type="application/rss+xml"/>
      <lastBuildDate>Fri, 07 Feb 2025 00:00:00 +0000</lastBuildDate>
      <item>
          <title>`just` OCaml</title>
          <pubDate>Fri, 07 Feb 2025 00:00:00 +0000</pubDate>
          <author>Richard Mortier</author>
          <link>https://mort.io/blog/just-ocaml/</link>
          <guid>https://mort.io/blog/just-ocaml/</guid>
          <description xml:base="https://mort.io/blog/just-ocaml/">&lt;p&gt;In similar vein to a &lt;a href=&quot;&#x2F;blog&#x2F;just-latex&quot;&gt;recent post&lt;&#x2F;a&gt;, I have also started using
&lt;a href=&quot;https:&#x2F;&#x2F;just.systems&#x2F;&quot;&gt;&lt;code&gt;just&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; when I periodically need to rebuild my
&lt;a href=&quot;https:&#x2F;&#x2F;ocaml.org&#x2F;&quot;&gt;OCaml&lt;&#x2F;a&gt; tool&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#1&quot;&gt;1&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;mor1&#x2F;ocal&quot;&gt;&lt;code&gt;ocal&lt;&#x2F;code&gt;&lt;&#x2F;a&gt;. So
I ended up replacing the old
&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;mor1&#x2F;ocal&#x2F;blob&#x2F;6bb129627f9d1f27ab31cee810013b362ab80067&#x2F;Makefile&quot;&gt;&lt;code&gt;Makefile&lt;&#x2F;code&gt;&lt;&#x2F;a&gt;
with a shiny new
&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;mor1&#x2F;ocal&#x2F;blob&#x2F;8ef8631ae5bbe0315e359d725d467e7d0403fd31&#x2F;Justfile&quot;&gt;&lt;code&gt;Justfile&lt;&#x2F;code&gt;&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;As it also proved useful in another (more esoteric) tool I wrote &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;mor1&#x2F;cst-tools&quot;&gt;for parsing
out exam results for my students so I can paste into email
easily&lt;&#x2F;a&gt;, I thought I’d put it here for the
record. So here it is…&lt;&#x2F;p&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;1&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;1&lt;&#x2F;sup&gt;
&lt;p&gt;Largely due to &lt;a href=&quot;https:&#x2F;&#x2F;nixos.org&#x2F;&quot;&gt;NixOS&lt;&#x2F;a&gt; upgrades moving tools into
different locations.&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;p&gt;Usual preamble of course:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;_default&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    &lt;span class=&quot;z-storage z-modifier z-quiet z-just&quot;&gt;@&lt;&#x2F;span&gt;just --list
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then set some common variables:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;PWD&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-just&quot;&gt;:=&lt;&#x2F;span&gt; &lt;span class=&quot;z-source z-just&quot;&gt;env&lt;&#x2F;span&gt;&lt;span class=&quot;z-invalid z-illegal z-just&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-string z-quoted z-double z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;PWD&lt;span class=&quot;z-punctuation z-definition z-string z-end z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;)
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;DOCDIR&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-just&quot;&gt;:=&lt;&#x2F;span&gt; &lt;span class=&quot;z-string z-quoted z-double z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;_build&#x2F;default&#x2F;_doc&#x2F;_html&lt;span class=&quot;z-punctuation z-definition z-string z-end z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;BUILDDIR&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-just&quot;&gt;:=&lt;&#x2F;span&gt; &lt;span class=&quot;z-string z-quoted z-double z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;_build&#x2F;install&#x2F;default&#x2F;bin&lt;span class=&quot;z-punctuation z-definition z-string z-end z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then set the target — the tool name, in this case &lt;code&gt;ocal&lt;&#x2F;code&gt; (so named as this is
an OCaml re-implementation of a tool approximating the trad Unix
&lt;a href=&quot;https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Cal_(command)&quot;&gt;&lt;code&gt;cal&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; tool):&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;TARGET&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-just&quot;&gt;:=&lt;&#x2F;span&gt; &lt;span class=&quot;z-string z-quoted z-double z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;ocal&lt;span class=&quot;z-punctuation z-definition z-string z-end z-just&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now for the actually useful stuff: some targets. Mostly these just call out to
&lt;code&gt;dune&lt;&#x2F;code&gt; but in a way I find more intuitive.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;build targets&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;build&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune build @all
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;cleanup&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;clean&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune clean
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;uninstall targets&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;uninstall&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune uninstall
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;run any tests&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;test&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune runtest
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;format sources&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;format&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune fmt
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Some compound calls next.&lt;&#x2F;p&gt;
&lt;p&gt;First, before building we might need to install dependencies, so do so in the
time-honoured fashion:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;install dependencies&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;depends&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    opam install --yes dune-release odoc
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    opam install --yes . --deps-only
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Next, to install I first build ready to install, then symlink the resulting
binary into the right place in my home directory:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;install targets&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;install&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;: build
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune build @install
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    ln -sf &lt;span class=&quot;z-meta z-interpolation z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-just&quot;&gt;{{&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;PWD&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-just&quot;&gt;}}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-interpolation z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-just&quot;&gt;{{&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;BUILDDIR&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-just&quot;&gt;}}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-interpolation z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-just&quot;&gt;{{&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;TARGET&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-just&quot;&gt;}}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; ~&#x2F;.local&#x2F;bin&#x2F;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;To lint all the things, invoke &lt;code&gt;dune&lt;&#x2F;code&gt; twice:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;lint everything&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;lint&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune build @lint
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune-release lint
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Similarly, to build the docs, build &lt;em&gt;all&lt;&#x2F;em&gt; the docs:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;build docs&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;doc&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune build @doc
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune build @doc-private
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Try to open the docs on Linux and if that fails, on MacOS:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;open the docs for reading&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;read&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;: doc
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    handlr open &lt;span class=&quot;z-meta z-interpolation z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-just&quot;&gt;{{&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;DOCDIR&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-just&quot;&gt;}}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;index.html || open &lt;span class=&quot;z-meta z-interpolation z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-just&quot;&gt;{{&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-just&quot;&gt;DOCDIR&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-just&quot;&gt;}}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Finally, tag and create a release; not actually done this in ages so no idea if
&lt;code&gt;dune-release&lt;&#x2F;code&gt; invocations are still a thing, let alone correct!&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;just&quot; class=&quot;language-just z-code&quot;&gt;&lt;code class=&quot;language-just&quot; data-lang=&quot;just&quot;&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-just&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-just&quot;&gt;# &lt;&#x2F;span&gt;tag and create a release&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;&lt;span class=&quot;z-meta z-function z-just&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-just&quot;&gt;release&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;:
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune-release tag
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-just&quot;&gt;    dune-release -vv
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</description>
      </item>
      <item>
          <title>Reverse `find`</title>
          <pubDate>Wed, 05 Feb 2025 00:00:00 +0000</pubDate>
          <author>Richard Mortier</author>
          <link>https://mort.io/blog/reverse-find/</link>
          <guid>https://mort.io/blog/reverse-find/</guid>
          <description xml:base="https://mort.io/blog/reverse-find/">&lt;p&gt;In the last few days I discovered I needed to search back up the filesystem from
&lt;code&gt;$CWD&lt;&#x2F;code&gt; to find the first occurence of a file (specifically, a &lt;code&gt;Justfile&lt;&#x2F;code&gt; but
that’s by-the-by). Got bored of doing it by hand so wrote a
&lt;a href=&quot;https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;bash&#x2F;&quot;&gt;&lt;code&gt;bash&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; shell function; here ’tis:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash z-code&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function z-shell&quot;&gt;&lt;span class=&quot;z-entity z-name z-function z-shell&quot;&gt;rf&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-section z-parens z-begin z-shell&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-parens z-end z-shell&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-section z-braces z-begin z-shell&quot;&gt;{&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function z-shell&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;  &lt;span class=&quot;z-storage z-modifier z-shell&quot;&gt;local&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-readwrite z-assignment z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function z-shell&quot;&gt;  &lt;span class=&quot;z-keyword z-control z-loop z-while z-shell&quot;&gt;while&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;!&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; eza&lt;span class=&quot;z-variable z-parameter z-option z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-parameter z-shell&quot;&gt; -&lt;&#x2F;span&gt;l&lt;&#x2F;span&gt; &lt;span class=&quot;z-string z-quoted z-double z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-expansion z-parameter z-begin z-shell&quot;&gt;{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-assignment z-shell&quot;&gt;:=&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;.&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-expansion z-parameter z-end z-shell&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;1&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-logical z-continue z-shell&quot;&gt;;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-loop z-do z-shell&quot;&gt;do&lt;&#x2F;span&gt;               &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; first, check `$CWD`&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function z-shell&quot;&gt;    &lt;span class=&quot;z-support z-function z-test z-begin z-shell&quot;&gt;[&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; &lt;span class=&quot;z-string z-quoted z-double z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-command z-parens z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-parens z-begin z-shell&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;realpath&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; &lt;span class=&quot;z-string z-quoted z-double z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;1&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-parens z-end z-shell&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-logical z-shell&quot;&gt;==&lt;&#x2F;span&gt; &lt;span class=&quot;z-string z-quoted z-double z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;1&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-support z-function z-test z-end z-shell&quot;&gt;]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-logical z-and z-shell&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-flow z-break z-shell&quot;&gt;break&lt;&#x2F;span&gt; &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; stop if we hit `&#x2F;` already&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function z-shell&quot;&gt;    &lt;span class=&quot;z-variable z-other z-readwrite z-assignment z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-assignment z-shell&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-string z-unquoted z-shell&quot;&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;..&lt;&#x2F;span&gt;                                     &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; else, iterate one layer up&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function z-shell&quot;&gt;  &lt;span class=&quot;z-keyword z-control z-loop z-end z-shell&quot;&gt;done&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-braces z-end z-shell&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Invoke as (e.g.,) &lt;code&gt;rf Justfile&lt;&#x2F;code&gt;. Alternatively, as a one-liner:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash z-code&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-assignment z-shell&quot;&gt;F&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-assignment z-shell&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-string z-unquoted z-shell&quot;&gt;Justfile&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-logical z-continue z-shell&quot;&gt;;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-loop z-while z-shell&quot;&gt;while&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;!&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; eza&lt;span class=&quot;z-variable z-parameter z-option z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-parameter z-shell&quot;&gt; -&lt;&#x2F;span&gt;l&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-expansion z-parameter z-begin z-shell&quot;&gt;{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-assignment z-shell&quot;&gt;:=&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;.&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-expansion z-parameter z-end z-shell&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;F&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-logical z-continue z-shell&quot;&gt;;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-loop z-do z-shell&quot;&gt;do&lt;&#x2F;span&gt; &lt;span class=&quot;z-support z-function z-test z-begin z-shell&quot;&gt;[&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; &lt;span class=&quot;z-string z-quoted z-double z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-expansion z-command z-parens z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-parens z-begin z-shell&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;realpath&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; &lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;F&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-parens z-end z-shell&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-logical z-shell&quot;&gt;==&lt;&#x2F;span&gt; &lt;span class=&quot;z-string z-quoted z-double z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&#x2F;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;F&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-shell&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-support z-function z-test z-end z-shell&quot;&gt;]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-logical z-and z-shell&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-flow z-break z-shell&quot;&gt;break&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-logical z-continue z-shell&quot;&gt;;&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-readwrite z-assignment z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-assignment z-shell&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-string z-unquoted z-shell&quot;&gt;&lt;span class=&quot;z-meta z-group z-expansion z-parameter z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-variable z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-readwrite z-shell&quot;&gt;D&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;..&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-logical z-continue z-shell&quot;&gt;;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-loop z-end z-shell&quot;&gt;done&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-logical z-continue z-shell&quot;&gt;;&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-support z-function z-unset z-shell&quot;&gt;unset&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; D&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</description>
      </item>
    </channel>
</rss>
